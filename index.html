<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>BLE Advertising Data</title>
  </head>
  <body>
    <h1>BLE Advertising Data</h1>
    <button id="scanButton">Start Scanning</button>
    <ul id="devicesList"></ul>

    <script>
      const scanButton = document.getElementById('scanButton');
      const devicesList = document.getElementById('devicesList');
      
      const targetDeviceAddress = '50:FB:19:5A:8C:22';
      
      const WEIGHT_DATA_OFFSET = 6;
      const WEIGHT_DATA_LENGTH = 4;
      const TEMPERATURE_DATA_OFFSET = 10;
      const TEMPERATURE_DATA_LENGTH = 2;

      scanButton.addEventListener('click', () => {
        navigator.bluetooth.requestLEScan({ acceptAllAdvertisements: true })
          .then(scanner => {
            console.log('Scanner created');

            scanner.onreading = event => {
              const device = event.device;
              const advertisement = event.target.advertisement;
              const address = device.id;
              const rssi = event.rssi;
              const data = advertisement.manufacturerData;
              
              if (address === targetDeviceAddress && data) {
                const weightData = data.getUint32(WEIGHT_DATA_OFFSET, true);
                const temperatureData = data.getUint16(TEMPERATURE_DATA_OFFSET, true) / 100.0;
                const listItem = document.createElement('li');
                listItem.textContent = `Device address: ${address}, RSSI: ${rssi}, Weight: ${weightData} g, Temperature: ${temperatureData} Â°C`;
                devicesList.appendChild(listItem);
              }
            };

            scanner.start();
          })
          .catch(error => {
            console.error(error);
          });
      });
    </script>
  </body>
</html>